{% extends "base.html" %}

{% block content %}
  <a class="back-link" href="{{ url_for('users') }}">Back to Users</a>

  <section class="page-header">
    <h1>Movies for {{ user.name }}</h1>
  </section>

  <section class="card add-movie">
    <h2>Add a movie</h2>
    <form class="form-row" method="post" action="{{ url_for('add_movie', user_id=user.id) }}">
      <input type="text" name="title" placeholder="Movie title" required>
      <button class="btn primary" type="submit">Add</button>
    </form>
  </section>

  <section class="movie-grid">
    {% for movie in movies %}
      <article class="movie-card">
        <div class="poster-frame">
          {% if movie.poster_url %}
            <img src="{{ movie.poster_url }}" alt="{{ movie.name }} poster">
          {% else %}
            <div class="poster-placeholder">No poster</div>
          {% endif %}
        </div>
        <div class="movie-info">
          <div class="movie-title">{{ movie.name }}</div>
          <a class="btn small" href="{{ url_for('edit_movie', user_id=user.id, movie_id=movie.id) }}">Update</a>
          <div class="movie-meta">Year: {{ movie.year or 'Unknown' }}</div>
          <div class="movie-meta">Director: {{ movie.director or 'Unknown' }}</div>
          <form method="post" action="{{ url_for('delete_movie', user_id=user.id, movie_id=movie.id) }}">
            <button class="btn danger" type="submit">Delete</button>
          </form>
        </div>
      </article>
    {% else %}
      <div class="empty-state">No movies yet. Add one above.</div>
    {% endfor %}
  </section>
{% endblock %}
